schema {
  query: Query
  mutation: Mutation
}

scalar Date

type Organization {
  id: ID!
  name: String!
  teams: [Team!]!
}

type Team {
  id: ID!
  name: String!
  users: [User!]!
  programs: [Program!]!
  organizations: [Organization!]!
}

type User {
  id: ID!
  firstName: String!
  lastName: String!
  email: String!
  roles: [Role!]!
  teams: [Team!]!
}

type Role {
  id: ID!
  name: String!
  description: String!
}

type Program {
  id: ID!
  name: String!
  description: String!
  team: Team!
  datasets: [Dataset!]!
  targets: [Target!]!
  tags: [Tag!]!
}

type Tag {
  id: ID!
  name: String!
  description: String
  tagType: String!
  programs: [Program!]!
  datasets: [Dataset!]!
}

input TagInput {
  name: String!
  description: String
  tagType: String!
}

type Target {
  id: ID!
  program: Program!
  category: String!
  categoryValue: String!
  target: Float!
}

type Dataset {
  id: ID!
  name: String!
  description: String
  program: Program!
  records: [Record!]!
  inputter: User!
  tags: [Tag!]!
}

# TODO checkin: shouldn't records be the ones flagged with inputter vs datasets
type Record {
  id: ID!
  dataset: Dataset!
  publicationDate: Date!
  data: [Data!]!
}

type Data {
  id: ID!
  category: String!
  categoryValue: String!
  count: Int!
}

input UpsertUserInput {
  id: ID
  firstName: String!
  lastName: String!
  email: String!
  role: String!
}

input CreateDatasetInput {
  name: String!
  description: String!
  programId: ID!
  inputterId: ID!
  tags: [TagInput!]!
}

input UpdateDatasetInput {
  id: ID!
  name: String
  description: String
  programId: ID
  inputterId: ID
  tags: [TagInput!]
}
input CreateRecordInput {
  datasetId: ID!
  publicationDate: Date!
  data: [DataInput!]
}

input DataInput {
  id: ID
  category: String!
  categoryValue: String!
  count: Int!
}

type UpsertDatasetRecordOutput {
  record: Record!
}

type DeleteDatasetRecordOutput {
  id: ID!
}

type Query {
  # Retrieve a single user.
  user(id: ID!): User

  # Retrieve a single dataset.
  dataset(id: ID!): Dataset

  # Retrieve a single Record.
  record(id: ID!): Record

  # Retriever a single program.
  program(id: ID!): Program
}

type Mutation {
  # Upsert a user.
  upsertUser(input: UpsertUserInput): User!

  # Delete a user.
  deleteUser(id: ID!): Int!

  # Create a Dataset
  createDataset(input: CreateDatasetInput): Dataset!

  # Delete a Dataset
  deleteDataset(id: ID!): String!
  # Update a Dataset
  updateDataset(input: UpdateDatasetInput): Dataset!

  # Create a record.
  createRecord(input: CreateRecordInput): Record!

  # Delete a record.
  deleteRecord(id: ID!): DeleteDatasetRecordOutput!
}
